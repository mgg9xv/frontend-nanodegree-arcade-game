function randomNum(e,n){return Math.round(Math.random()*(n-e)+e)}function distance(e,n,t,i){return Math.sqrt((n-e)*(n-e)+(i-t)*(i-t))}function checkCollisions(){allEnemies.forEach(function(e){distance(player.x,e.x,player.y,e.y)<50*scale&&(lives--,updateLives(),player.reset())})}function updateScore(){document.getElementById("score").innerHTML="Score: "+score}function updateLives(){for(var e="",n=0;n<lives;)e+="<img class='heart-img' src='images/src/Heart.png'>",n++;document.getElementById("lives").innerHTML=e,0===lives&&(alert("You have lost all your lives. Press OK to play again."),score=0,updateScore(),lives=10,updateLives())}!function(){function e(e){e instanceof Array?e.forEach(function(e){n(e)}):n(e)}function n(e){if(r[e])return r[e];var n=new Image;n.onload=function(){r[e]=n,i()&&s.forEach(function(e){e()})},r[e]=!1,n.src=e}function t(e){return r[e]}function i(){var e=!0;for(var n in r)r.hasOwnProperty(n)&&!r[n]&&(e=!1);return e}function a(e){s.push(e)}var r={},s=[];window.Resources={load:e,get:t,onReady:a,isReady:i}}();var score=0,lives=5,suffix,scale;window.innerWidth<1e3?(suffix="-small",scale=.5):window.innerWidth<1400?(suffix="-medium",scale=.75):(suffix="-large",scale=1);var Enemy=function(){this.x=randomNum(-100,-250),this.y=randomNum(0,2)*(85*scale)+62.5*scale,this.v=randomNum(25,125),this.sprite="images/enemy-bug"+suffix+".png"};Enemy.prototype.update=function(e){this.x=this.x+e*this.v,this.x>500*scale&&this.reset()},Enemy.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)},Enemy.prototype.reset=function(){this.x=randomNum(-100,-150),this.y=85*randomNum(0,2)+62.5,this.v=randomNum(25,125)};var Player=function(e,n){this.x=e,this.y=n,this.sprite="images/char-boy"+suffix+".png"};Player.prototype.update=function(e){this.y<0&&(score++,updateScore(),this.reset())},Player.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)},Player.prototype.reset=function(){this.x=200*scale,this.y=385*scale},Player.prototype.handleInput=function(e){var n=100*scale,t=85*scale;switch(e){case"left":this.x>0&&(this.x=this.x-n);break;case"right":this.x<400*scale&&(this.x=this.x+n);break;case"up":this.y>0&&(this.y=this.y-t);break;case"down":this.y<385*scale&&(this.y=this.y+t)}};var allEnemies=[new Enemy,new Enemy,new Enemy],player=new Player(200*scale,385*scale);document.addEventListener("keyup",function(e){e.preventDefault();var n={37:"left",38:"up",39:"right",40:"down"};player.handleInput(n[e.keyCode])}),document.querySelector("#up-arrow").addEventListener("click",function(e){e.preventDefault(),player.handleInput("up")}),document.querySelector("#left-arrow").addEventListener("click",function(e){e.preventDefault(),player.handleInput("left")}),document.querySelector("#right-arrow").addEventListener("click",function(e){e.preventDefault(),player.handleInput("right")}),document.querySelector("#down-arrow").addEventListener("click",function(e){e.preventDefault(),player.handleInput("down")});var Engine=function(e){function n(){var e=Date.now();i((e-o)/1e3),r(),o=e,h.requestAnimationFrame(n)}function t(){o=Date.now(),n()}function i(e){a(e),checkCollisions()}function a(e){allEnemies.forEach(function(n){n.update(e)}),player.update()}function r(){var e,n,t=["images/water-block"+c+".png","images/stone-block"+c+".png","images/stone-block"+c+".png","images/stone-block"+c+".png","images/grass-block"+c+".png","images/grass-block"+c+".png"];for(e=0;e<6;e++)for(n=0;n<5;n++)f.drawImage(Resources.get(t[e]),n*l,e*u);s()}function s(){allEnemies.forEach(function(e){e.render()}),player.render()}var o,c,u,l,d=e.document,h=e.window,p=d.createElement("canvas"),f=p.getContext("2d");e.window.innerWidth<1e3?(c="-small",p.width=250,p.height=300,u=42,l=50):window.innerWidth<1400?(c="-medium",p.width=375,p.height=450,u=62,l=75):(c="-large",p.width=505,p.height=606,u=83,l=101),d.getElementById("game").appendChild(p);var m=["images/stone-block"+c+".png","images/water-block"+c+".png","images/grass-block"+c+".png","images/enemy-bug"+c+".png","images/char-boy"+c+".png"];Resources.load(m),Resources.onReady(t),e.ctx=f}(this);